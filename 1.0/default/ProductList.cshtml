@inherits RocketCatalog.Components.RocketCatalogTokens<Simplisity.SimplisityRazor>
@using DNNrocketAPI;
@using Simplisity;
@using RocketPortal.Components;
@using RocketCatalog.Components;
@using DNNrocketAPI.Components;
@using System.Globalization;

@AddProcessData("resourcepath", "/DesktopModules/DNNrocket/api/App_LocalResources/")
@AddProcessData("resourcepath", "/DesktopModules/DNNrocketModules/RocketCatalog/App_LocalResources/")

@{ var sessionParams = (SessionParams)Model.SessionParamsData;
    var articleDataList = (ArticleLimpetList)Model.GetDataObject("articlelist");
    var portalCatalog = (PortalCatalogLimpet)Model.GetDataObject("portalcatalog");
    var remoteModule = (RemoteModule)Model.GetDataObject("remotemodule");
    var portalData = (PortalLimpet)Model.GetDataObject("portaldata");
    var categoryList = (CategoryLimpetList)Model.GetDataObject("categorylist");
    var appTheme = (AppThemeLimpet)Model.GetDataObject("apptheme");
    var appThemeDefault = (AppThemeLimpet)Model.GetDataObject("appthemedefault");
    var categoryData = new CategoryLimpet(portalCatalog.PortalId, articleDataList.CategoryId, sessionParams.CultureCode);

    var hbsDict = new Dictionary<string, SimplisityInfo>();
    hbsDict.Add("sessionparams", sessionParams.Info);
    hbsDict.Add("resxlist", RenderRazorUtils.GetResxPaths(Processdata));

    var lp = 1;

}

@AddProcessData("resourcepath", appTheme.AppThemeVersionFolderRel + "/resx/")

@if (portalCatalog.DebugMode)
{<div class="w3-small">@DateTime.Now.ToString()</div>}

<h1>
    @if (sessionParams.GetInt("catid") == 0)
    {
        <span>@articleDataList.Dashboard.Title&nbsp;</span> }
    else
    {
        <span>@categoryData.Name&nbsp;</span>}
</h1>


<div class="w3-row-padding w3-padding-16 w3-center">
    @foreach (ArticleLimpet articleData in articleDataList.GetArticleList())
    {
        var modLp = (lp % 5);
        if (modLp == 0)
        {
            @Raw("</div>")
            @Raw("<div class=\"w3-row-padding w3-padding-16 w3-center\">")
            hbsDict.Remove("data");
            hbsDict.Add("data", articleData.Info);
            var cacheKey = "list" + articleData.ArticleId.ToString();
            @RenderHandleBars(hbsDict, appTheme, "productlistrow.hbs", remoteModule.ModuleRef, cacheKey)
        }
        else
        {
            hbsDict.Remove("data");
            hbsDict.Add("data", articleData.Info);
            var cacheKey = "list" + articleData.ArticleId.ToString();
            @RenderHandleBars(hbsDict, appTheme, "productlistrow.hbs", remoteModule.ModuleRef, cacheKey)
        }

        lp += 1;
    }
</div>
